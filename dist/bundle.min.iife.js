var LikecoinCryptoJS=function(){var t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var e,r,i,s,n,o=(function(e){!function(){var r="input is invalid type",i="object"==typeof window,s=i?window:{};s.JS_SHA3_NO_WINDOW&&(i=!1);var n=!i&&"object"==typeof self;!s.JS_SHA3_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node?s=t:n&&(s=self);var o=!s.JS_SHA3_NO_COMMON_JS&&e.exports,a=!s.JS_SHA3_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,h="0123456789abcdef".split(""),u=[4,1024,262144,67108864],c=[0,8,16,24],f=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],p=[224,256,384,512],l=[128,256],y=["hex","buffer","arrayBuffer","array","digest"],g={128:168,256:136};!s.JS_SHA3_NO_NODE_JS&&Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),!a||!s.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(t){return"object"==typeof t&&t.buffer&&t.buffer.constructor===ArrayBuffer});for(var v=function(t,e,r){return function(i){return new K(t,e,t).update(i)[r]()}},m=function(t,e,r){return function(i,s){return new K(t,e,s).update(i)[r]()}},d=function(t,e,r){return function(e,i,s,n){return B["cshake"+t].update(e,i,s,n)[r]()}},S=function(t,e,r){return function(e,i,s,n){return B["kmac"+t].update(e,i,s,n)[r]()}},b=function(t,e,r,i){for(var s=0;s<y.length;++s){var n=y[s];t[n]=e(r,i,n)}return t},w=function(t,e){var r=v(t,e,"hex");return r.create=function(){return new K(t,e,t)},r.update=function(t){return r.create().update(t)},b(r,v,t,e)},A=[{name:"keccak",padding:[1,256,65536,16777216],bits:p,createMethod:w},{name:"sha3",padding:[6,1536,393216,100663296],bits:p,createMethod:w},{name:"shake",padding:[31,7936,2031616,520093696],bits:l,createMethod:function(t,e){var r=m(t,e,"hex");return r.create=function(r){return new K(t,e,r)},r.update=function(t,e){return r.create(e).update(t)},b(r,m,t,e)}},{name:"cshake",padding:u,bits:l,createMethod:function(t,e){var r=g[t],i=d(t,0,"hex");return i.create=function(i,s,n){return s||n?new K(t,e,i).bytepad([s,n],r):B["shake"+t].create(i)},i.update=function(t,e,r,s){return i.create(e,r,s).update(t)},b(i,d,t,e)}},{name:"kmac",padding:u,bits:l,createMethod:function(t,e){var r=g[t],i=S(t,0,"hex");return i.create=function(i,s,n){return new I(t,e,s).bytepad(["KMAC",n],r).bytepad([i],r)},i.update=function(t,e,r,s){return i.create(t,r,s).update(e)},b(i,S,t,e)}}],B={},x=[],N=0;N<A.length;++N)for(var D=A[N],C=D.bits,E=0;E<C.length;++E){var R=D.name+"_"+C[E];if(x.push(R),B[R]=D.createMethod(C[E],D.padding),"sha3"!==D.name){var T=D.name+C[E];x.push(T),B[T]=B[R]}}function K(t,e,r){this.blocks=[],this.s=[],this.padding=e,this.outputBits=r,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(t<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=r>>5,this.extraBytes=(31&r)>>3;for(var i=0;i<50;++i)this.s[i]=0}function I(t,e,r){K.call(this,t,e,r)}K.prototype.update=function(t){if(!this.finalized){var e,i=typeof t;if("string"!==i){if("object"!==i)throw r;if(null===t)throw r;if(a&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!(Array.isArray(t)||a&&ArrayBuffer.isView(t)))throw r;e=!0}for(var s,n,o=this.blocks,h=this.byteCount,u=t.length,f=this.blockCount,p=0,l=this.s;p<u;){if(this.reset)for(this.reset=!1,o[0]=this.block,s=1;s<f+1;++s)o[s]=0;if(e)for(s=this.start;p<u&&s<h;++p)o[s>>2]|=t[p]<<c[3&s++];else for(s=this.start;p<u&&s<h;++p)(n=t.charCodeAt(p))<128?o[s>>2]|=n<<c[3&s++]:n<2048?(o[s>>2]|=(192|n>>6)<<c[3&s++],o[s>>2]|=(128|63&n)<<c[3&s++]):n<55296||n>=57344?(o[s>>2]|=(224|n>>12)<<c[3&s++],o[s>>2]|=(128|n>>6&63)<<c[3&s++],o[s>>2]|=(128|63&n)<<c[3&s++]):(n=65536+((1023&n)<<10|1023&t.charCodeAt(++p)),o[s>>2]|=(240|n>>18)<<c[3&s++],o[s>>2]|=(128|n>>12&63)<<c[3&s++],o[s>>2]|=(128|n>>6&63)<<c[3&s++],o[s>>2]|=(128|63&n)<<c[3&s++]);if(this.lastByteIndex=s,s>=h){for(this.start=s-h,this.block=o[f],s=0;s<f;++s)l[s]^=o[s];H(l),this.reset=!0}else this.start=s}return this}},K.prototype.encode=function(t,e){var r=255&t,i=1,s=[r];for(r=255&(t>>=8);r>0;)s.unshift(r),r=255&(t>>=8),++i;return e?s.push(i):s.unshift(i),this.update(s),s.length},K.prototype.encodeString=function(t){var e,i=typeof t;if("string"!==i){if("object"!==i)throw r;if(null===t)throw r;if(a&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!(Array.isArray(t)||a&&ArrayBuffer.isView(t)))throw r;e=!0}var s=0,n=t.length;if(e)s=n;else for(var o=0;o<t.length;++o){var h=t.charCodeAt(o);h<128?s+=1:h<2048?s+=2:h<55296||h>=57344?s+=3:(h=65536+((1023&h)<<10|1023&t.charCodeAt(++o)),s+=4)}return s+=this.encode(8*s),this.update(t),s},K.prototype.bytepad=function(t,e){for(var r=this.encode(e),i=0;i<t.length;++i)r+=this.encodeString(t[i]);var s=e-r%e,n=[];return n.length=s,this.update(n),this},K.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex,r=this.blockCount,i=this.s;if(t[e>>2]|=this.padding[3&e],this.lastByteIndex===this.byteCount)for(t[0]=t[r],e=1;e<r+1;++e)t[e]=0;for(t[r-1]|=2147483648,e=0;e<r;++e)i[e]^=t[e];H(i)}},K.prototype.toString=K.prototype.hex=function(){this.finalize();for(var t,e=this.blockCount,r=this.s,i=this.outputBlocks,s=this.extraBytes,n=0,o=0,a="";o<i;){for(n=0;n<e&&o<i;++n,++o)t=r[n],a+=h[t>>4&15]+h[15&t]+h[t>>12&15]+h[t>>8&15]+h[t>>20&15]+h[t>>16&15]+h[t>>28&15]+h[t>>24&15];o%e==0&&(H(r),n=0)}return s&&(t=r[n],a+=h[t>>4&15]+h[15&t],s>1&&(a+=h[t>>12&15]+h[t>>8&15]),s>2&&(a+=h[t>>20&15]+h[t>>16&15])),a},K.prototype.arrayBuffer=function(){this.finalize();var t,e=this.blockCount,r=this.s,i=this.outputBlocks,s=this.extraBytes,n=0,o=0,a=this.outputBits>>3;t=s?new ArrayBuffer(i+1<<2):new ArrayBuffer(a);for(var h=new Uint32Array(t);o<i;){for(n=0;n<e&&o<i;++n,++o)h[o]=r[n];o%e==0&&H(r)}return s&&(h[n]=r[n],t=t.slice(0,a)),t},K.prototype.buffer=K.prototype.arrayBuffer,K.prototype.digest=K.prototype.array=function(){this.finalize();for(var t,e,r=this.blockCount,i=this.s,s=this.outputBlocks,n=this.extraBytes,o=0,a=0,h=[];a<s;){for(o=0;o<r&&a<s;++o,++a)t=a<<2,e=i[o],h[t]=255&e,h[t+1]=e>>8&255,h[t+2]=e>>16&255,h[t+3]=e>>24&255;a%r==0&&H(i)}return n&&(t=a<<2,e=i[o],h[t]=255&e,n>1&&(h[t+1]=e>>8&255),n>2&&(h[t+2]=e>>16&255)),h},I.prototype=new K,I.prototype.finalize=function(){return this.encode(this.outputBits,!0),K.prototype.finalize.call(this)};var H=function(t){var e,r,i,s,n,o,a,h,u,c,p,l,y,g,v,m,d,S,b,w,A,B,x,N,D,C,E,R,T,K,I,H,P,k,U,J,O,M,_,V,F,z,X,q,j,Z,L,G,W,Y,Q,$,tt,et,rt,it,st,nt,ot,at,ht,ut,ct;for(i=0;i<48;i+=2)s=t[0]^t[10]^t[20]^t[30]^t[40],n=t[1]^t[11]^t[21]^t[31]^t[41],o=t[2]^t[12]^t[22]^t[32]^t[42],a=t[3]^t[13]^t[23]^t[33]^t[43],h=t[4]^t[14]^t[24]^t[34]^t[44],u=t[5]^t[15]^t[25]^t[35]^t[45],c=t[6]^t[16]^t[26]^t[36]^t[46],p=t[7]^t[17]^t[27]^t[37]^t[47],e=(l=t[8]^t[18]^t[28]^t[38]^t[48])^(o<<1|a>>>31),r=(y=t[9]^t[19]^t[29]^t[39]^t[49])^(a<<1|o>>>31),t[0]^=e,t[1]^=r,t[10]^=e,t[11]^=r,t[20]^=e,t[21]^=r,t[30]^=e,t[31]^=r,t[40]^=e,t[41]^=r,e=s^(h<<1|u>>>31),r=n^(u<<1|h>>>31),t[2]^=e,t[3]^=r,t[12]^=e,t[13]^=r,t[22]^=e,t[23]^=r,t[32]^=e,t[33]^=r,t[42]^=e,t[43]^=r,e=o^(c<<1|p>>>31),r=a^(p<<1|c>>>31),t[4]^=e,t[5]^=r,t[14]^=e,t[15]^=r,t[24]^=e,t[25]^=r,t[34]^=e,t[35]^=r,t[44]^=e,t[45]^=r,e=h^(l<<1|y>>>31),r=u^(y<<1|l>>>31),t[6]^=e,t[7]^=r,t[16]^=e,t[17]^=r,t[26]^=e,t[27]^=r,t[36]^=e,t[37]^=r,t[46]^=e,t[47]^=r,e=c^(s<<1|n>>>31),r=p^(n<<1|s>>>31),t[8]^=e,t[9]^=r,t[18]^=e,t[19]^=r,t[28]^=e,t[29]^=r,t[38]^=e,t[39]^=r,t[48]^=e,t[49]^=r,g=t[0],v=t[1],Z=t[11]<<4|t[10]>>>28,L=t[10]<<4|t[11]>>>28,R=t[20]<<3|t[21]>>>29,T=t[21]<<3|t[20]>>>29,at=t[31]<<9|t[30]>>>23,ht=t[30]<<9|t[31]>>>23,z=t[40]<<18|t[41]>>>14,X=t[41]<<18|t[40]>>>14,k=t[2]<<1|t[3]>>>31,U=t[3]<<1|t[2]>>>31,m=t[13]<<12|t[12]>>>20,d=t[12]<<12|t[13]>>>20,G=t[22]<<10|t[23]>>>22,W=t[23]<<10|t[22]>>>22,K=t[33]<<13|t[32]>>>19,I=t[32]<<13|t[33]>>>19,ut=t[42]<<2|t[43]>>>30,ct=t[43]<<2|t[42]>>>30,et=t[5]<<30|t[4]>>>2,rt=t[4]<<30|t[5]>>>2,J=t[14]<<6|t[15]>>>26,O=t[15]<<6|t[14]>>>26,S=t[25]<<11|t[24]>>>21,b=t[24]<<11|t[25]>>>21,Y=t[34]<<15|t[35]>>>17,Q=t[35]<<15|t[34]>>>17,H=t[45]<<29|t[44]>>>3,P=t[44]<<29|t[45]>>>3,N=t[6]<<28|t[7]>>>4,D=t[7]<<28|t[6]>>>4,it=t[17]<<23|t[16]>>>9,st=t[16]<<23|t[17]>>>9,M=t[26]<<25|t[27]>>>7,_=t[27]<<25|t[26]>>>7,w=t[36]<<21|t[37]>>>11,A=t[37]<<21|t[36]>>>11,$=t[47]<<24|t[46]>>>8,tt=t[46]<<24|t[47]>>>8,q=t[8]<<27|t[9]>>>5,j=t[9]<<27|t[8]>>>5,C=t[18]<<20|t[19]>>>12,E=t[19]<<20|t[18]>>>12,nt=t[29]<<7|t[28]>>>25,ot=t[28]<<7|t[29]>>>25,V=t[38]<<8|t[39]>>>24,F=t[39]<<8|t[38]>>>24,B=t[48]<<14|t[49]>>>18,x=t[49]<<14|t[48]>>>18,t[0]=g^~m&S,t[1]=v^~d&b,t[10]=N^~C&R,t[11]=D^~E&T,t[20]=k^~J&M,t[21]=U^~O&_,t[30]=q^~Z&G,t[31]=j^~L&W,t[40]=et^~it&nt,t[41]=rt^~st&ot,t[2]=m^~S&w,t[3]=d^~b&A,t[12]=C^~R&K,t[13]=E^~T&I,t[22]=J^~M&V,t[23]=O^~_&F,t[32]=Z^~G&Y,t[33]=L^~W&Q,t[42]=it^~nt&at,t[43]=st^~ot&ht,t[4]=S^~w&B,t[5]=b^~A&x,t[14]=R^~K&H,t[15]=T^~I&P,t[24]=M^~V&z,t[25]=_^~F&X,t[34]=G^~Y&$,t[35]=W^~Q&tt,t[44]=nt^~at&ut,t[45]=ot^~ht&ct,t[6]=w^~B&g,t[7]=A^~x&v,t[16]=K^~H&N,t[17]=I^~P&D,t[26]=V^~z&k,t[27]=F^~X&U,t[36]=Y^~$&q,t[37]=Q^~tt&j,t[46]=at^~ut&et,t[47]=ht^~ct&rt,t[8]=B^~g&m,t[9]=x^~v&d,t[18]=H^~N&C,t[19]=P^~D&E,t[28]=z^~k&J,t[29]=X^~U&O,t[38]=$^~q&Z,t[39]=tt^~j&L,t[48]=ut^~et&it,t[49]=ct^~rt&st,t[0]^=f[i],t[1]^=f[i+1]};if(o)e.exports=B;else{for(N=0;N<x.length;++N)s[x[N]]=B[x[N]];0}}()}(e={exports:{}},e.exports),e.exports);if(null==r){var a;if(r=new Array,i=0,void 0!==window&&(void 0!==window.crypto||void 0!==window.msCrypto)){var h=window.crypto||window.msCrypto;if(h.getRandomValues){var u=new Uint8Array(32);for(h.getRandomValues(u),a=0;a<32;++a)r[i++]=u[a]}else if("Netscape"==navigator.appName&&navigator.appVersion<"5"){var c=window.crypto.random(32);for(a=0;a<c.length;++a)r[i++]=255&c.charCodeAt(a)}}for(;i<rng_psize;)a=Math.floor(65536*Math.random()),r[i++]=a>>>8,r[i++]=255&a;i=0,s=(new Date).getTime(),r[i++]^=255&s,r[i++]^=s>>8&255,r[i++]^=s>>16&255,r[i++]^=s>>24&255,i>=rng_psize&&(i-=rng_psize)}function f(t,e,r){null!=t&&("number"==typeof t?this.fromNumber(t,e,r):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function p(){return new f(null)}"Microsoft Internet Explorer"==navigator.appName?(f.prototype.am=function(t,e,r,i,s,n){for(var o=32767&e,a=e>>15;--n>=0;){var h=32767&this[t],u=this[t++]>>15,c=a*h+u*o;s=((h=o*h+((32767&c)<<15)+r[i]+(1073741823&s))>>>30)+(c>>>15)+a*u+(s>>>30),r[i++]=1073741823&h}return s},n=30):"Netscape"!=navigator.appName?(f.prototype.am=function(t,e,r,i,s,n){for(;--n>=0;){var o=e*this[t++]+r[i]+s;s=Math.floor(o/67108864),r[i++]=67108863&o}return s},n=26):(f.prototype.am=function(t,e,r,i,s,n){for(var o=16383&e,a=e>>14;--n>=0;){var h=16383&this[t],u=this[t++]>>14,c=a*h+u*o;s=((h=o*h+((16383&c)<<14)+r[i]+s)>>28)+(c>>14)+a*u,r[i++]=268435455&h}return s},n=28),f.prototype.DB=n,f.prototype.DM=(1<<n)-1,f.prototype.DV=1<<n;f.prototype.FV=Math.pow(2,52),f.prototype.F1=52-n,f.prototype.F2=2*n-52;var l,y,g="0123456789abcdefghijklmnopqrstuvwxyz",v=new Array;for(l="0".charCodeAt(0),y=0;y<=9;++y)v[l++]=y;for(l="a".charCodeAt(0),y=10;y<36;++y)v[l++]=y;for(l="A".charCodeAt(0),y=10;y<36;++y)v[l++]=y;function m(t){return g.charAt(t)}function d(t,e){var r=v[t.charCodeAt(e)];return null==r?-1:r}function S(t){var e=p();return e.fromInt(t),e}function b(t){var e,r=1;return 0!=(e=t>>>16)&&(t=e,r+=16),0!=(e=t>>8)&&(t=e,r+=8),0!=(e=t>>4)&&(t=e,r+=4),0!=(e=t>>2)&&(t=e,r+=2),0!=(e=t>>1)&&(t=e,r+=1),r}function w(t){this.m=t}function A(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}w.prototype.convert=function(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t},w.prototype.revert=function(t){return t},w.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},w.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},w.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},A.prototype.convert=function(t){var e=p();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(f.ZERO)>0&&this.m.subTo(e,e),e},A.prototype.revert=function(t){var e=p();return t.copyTo(e),this.reduce(e),e},A.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=32767&t[e],i=r*this.mpl+((r*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[r=e+this.m.t]+=this.m.am(0,i,t,e,0,this.m.t);t[r]>=t.DV;)t[r]-=t.DV,t[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)},A.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},A.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},f.prototype.copyTo=function(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s},f.prototype.fromInt=function(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0},f.prototype.fromString=function(t,e){var r;if(16==e)r=4;else if(8==e)r=3;else if(256==e)r=8;else if(2==e)r=1;else if(32==e)r=5;else{if(4!=e)return void this.fromRadix(t,e);r=2}this.t=0,this.s=0;for(var i=t.length,s=!1,n=0;--i>=0;){var o=8==r?255&t[i]:d(t,i);o<0?"-"==t.charAt(i)&&(s=!0):(s=!1,0==n?this[this.t++]=o:n+r>this.DB?(this[this.t-1]|=(o&(1<<this.DB-n)-1)<<n,this[this.t++]=o>>this.DB-n):this[this.t-1]|=o<<n,(n+=r)>=this.DB&&(n-=this.DB))}8==r&&0!=(128&t[0])&&(this.s=-1,n>0&&(this[this.t-1]|=(1<<this.DB-n)-1<<n)),this.clamp(),s&&f.ZERO.subTo(this,this)},f.prototype.clamp=function(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t},f.prototype.dlShiftTo=function(t,e){var r;for(r=this.t-1;r>=0;--r)e[r+t]=this[r];for(r=t-1;r>=0;--r)e[r]=0;e.t=this.t+t,e.s=this.s},f.prototype.drShiftTo=function(t,e){for(var r=t;r<this.t;++r)e[r-t]=this[r];e.t=Math.max(this.t-t,0),e.s=this.s},f.prototype.lShiftTo=function(t,e){var r,i=t%this.DB,s=this.DB-i,n=(1<<s)-1,o=Math.floor(t/this.DB),a=this.s<<i&this.DM;for(r=this.t-1;r>=0;--r)e[r+o+1]=this[r]>>s|a,a=(this[r]&n)<<i;for(r=o-1;r>=0;--r)e[r]=0;e[o]=a,e.t=this.t+o+1,e.s=this.s,e.clamp()},f.prototype.rShiftTo=function(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t)e.t=0;else{var i=t%this.DB,s=this.DB-i,n=(1<<i)-1;e[0]=this[r]>>i;for(var o=r+1;o<this.t;++o)e[o-r-1]|=(this[o]&n)<<s,e[o-r]=this[o]>>i;i>0&&(e[this.t-r-1]|=(this.s&n)<<s),e.t=this.t-r,e.clamp()}},f.prototype.subTo=function(t,e){for(var r=0,i=0,s=Math.min(t.t,this.t);r<s;)i+=this[r]-t[r],e[r++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i-=t.s;r<this.t;)i+=this[r],e[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<t.t;)i-=t[r],e[r++]=i&this.DM,i>>=this.DB;i-=t.s}e.s=i<0?-1:0,i<-1?e[r++]=this.DV+i:i>0&&(e[r++]=i),e.t=r,e.clamp()},f.prototype.multiplyTo=function(t,e){var r=this.abs(),i=t.abs(),s=r.t;for(e.t=s+i.t;--s>=0;)e[s]=0;for(s=0;s<i.t;++s)e[s+r.t]=r.am(0,i[s],e,s,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&f.ZERO.subTo(e,e)},f.prototype.squareTo=function(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t[r]=0;for(r=0;r<e.t-1;++r){var i=e.am(r,e[r],t,2*r,0,1);(t[r+e.t]+=e.am(r+1,2*e[r],t,2*r+1,i,e.t-r-1))>=e.DV&&(t[r+e.t]-=e.DV,t[r+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(r,e[r],t,2*r,0,1)),t.s=0,t.clamp()},f.prototype.divRemTo=function(t,e,r){var i=t.abs();if(!(i.t<=0)){var s=this.abs();if(s.t<i.t)return null!=e&&e.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=p());var n=p(),o=this.s,a=t.s,h=this.DB-b(i[i.t-1]);h>0?(i.lShiftTo(h,n),s.lShiftTo(h,r)):(i.copyTo(n),s.copyTo(r));var u=n.t,c=n[u-1];if(0!=c){var l=c*(1<<this.F1)+(u>1?n[u-2]>>this.F2:0),y=this.FV/l,g=(1<<this.F1)/l,v=1<<this.F2,m=r.t,d=m-u,S=null==e?p():e;for(n.dlShiftTo(d,S),r.compareTo(S)>=0&&(r[r.t++]=1,r.subTo(S,r)),f.ONE.dlShiftTo(u,S),S.subTo(n,n);n.t<u;)n[n.t++]=0;for(;--d>=0;){var w=r[--m]==c?this.DM:Math.floor(r[m]*y+(r[m-1]+v)*g);if((r[m]+=n.am(0,w,r,d,0,u))<w)for(n.dlShiftTo(d,S),r.subTo(S,r);r[m]<--w;)r.subTo(S,r)}null!=e&&(r.drShiftTo(u,e),o!=a&&f.ZERO.subTo(e,e)),r.t=u,r.clamp(),h>0&&r.rShiftTo(h,r),o<0&&f.ZERO.subTo(r,r)}}},f.prototype.invDigit=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return(e=(e=(e=(e=e*(2-(15&t)*e)&15)*(2-(255&t)*e)&255)*(2-((65535&t)*e&65535))&65535)*(2-t*e%this.DV)%this.DV)>0?this.DV-e:-e},f.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},f.prototype.exp=function(t,e){if(t>4294967295||t<1)return f.ONE;var r=p(),i=p(),s=e.convert(this),n=b(t)-1;for(s.copyTo(r);--n>=0;)if(e.sqrTo(r,i),(t&1<<n)>0)e.mulTo(i,s,r);else{var o=r;r=i,i=o}return e.revert(r)},f.prototype.toString=function(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var r,i=(1<<e)-1,s=!1,n="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(r=this[o]>>a)>0&&(s=!0,n=m(r));o>=0;)a<e?(r=(this[o]&(1<<a)-1)<<e-a,r|=this[--o]>>(a+=this.DB-e)):(r=this[o]>>(a-=e)&i,a<=0&&(a+=this.DB,--o)),r>0&&(s=!0),s&&(n+=m(r));return s?n:"0"},f.prototype.negate=function(){var t=p();return f.ZERO.subTo(this,t),t},f.prototype.abs=function(){return this.s<0?this.negate():this},f.prototype.compareTo=function(t){var e=this.s-t.s;if(0!=e)return e;var r=this.t;if(0!=(e=r-t.t))return this.s<0?-e:e;for(;--r>=0;)if(0!=(e=this[r]-t[r]))return e;return 0},f.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+b(this[this.t-1]^this.s&this.DM)},f.prototype.mod=function(t){var e=p();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(f.ZERO)>0&&t.subTo(e,e),e},f.prototype.modPowInt=function(t,e){var r;return r=t<256||e.isEven()?new w(e):new A(e),this.exp(t,r)},f.ZERO=S(0),f.ONE=S(1),"undefined"!=typeof KJUR&&KJUR||(KJUR={}),void 0!==KJUR.crypto&&KJUR.crypto||(KJUR.crypto={}),KJUR.crypto.ECDSA=function(t){var e=new SecureRandom;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(t){return new BigInteger(t.bitLength(),e).mod(t.subtract(BigInteger.ONE)).add(BigInteger.ONE)},this.setNamedCurve=function(t){this.ecparams=KJUR.crypto.ECParameterDB.getByName(t),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=t},this.setPrivateKeyHex=function(t){this.isPrivate=!0,this.prvKeyHex=t},this.setPublicKeyHex=function(t){this.isPublic=!0,this.pubKeyHex=t},this.getPublicKeyXYHex=function(){var t=this.pubKeyHex;if("04"!==t.substr(0,2))throw"this method supports uncompressed format(04) only";var e=this.ecparams.keylen/4;if(t.length!==2+2*e)throw"malformed public key hex length";var r={};return r.x=t.substr(2,e),r.y=t.substr(2+e),r},this.getShortNISTPCurveName=function(){var t=this.curveName;return"secp256r1"===t||"NIST P-256"===t||"P-256"===t||"prime256v1"===t?"P-256":"secp384r1"===t||"NIST P-384"===t||"P-384"===t?"P-384":null},this.generateKeyPairHex=function(){var t=this.ecparams.n,e=this.getBigRandom(t),r=this.ecparams.G.multiply(e),i=r.getX().toBigInteger(),s=r.getY().toBigInteger(),n=this.ecparams.keylen/4,o=("0000000000"+e.toString(16)).slice(-n),a="04"+("0000000000"+i.toString(16)).slice(-n)+("0000000000"+s.toString(16)).slice(-n);return this.setPrivateKeyHex(o),this.setPublicKeyHex(a),{ecprvhex:o,ecpubhex:a}},this.signWithMessageHash=function(t){return this.signHex(t,this.prvKeyHex)},this.signHex=function(t,e){var r=new BigInteger(e,16),i=this.ecparams.n,s=new BigInteger(t,16);do{var n=this.getBigRandom(i),o=this.ecparams.G.multiply(n).getX().toBigInteger().mod(i)}while(o.compareTo(BigInteger.ZERO)<=0);var a=n.modInverse(i).multiply(s.add(r.multiply(o))).mod(i);return KJUR.crypto.ECDSA.biRSSigToASN1Sig(o,a)},this.sign=function(t,e){var r=e,i=this.ecparams.n,s=BigInteger.fromByteArrayUnsigned(t);do{var n=this.getBigRandom(i),o=this.ecparams.G.multiply(n).getX().toBigInteger().mod(i)}while(o.compareTo(BigInteger.ZERO)<=0);var a=n.modInverse(i).multiply(s.add(r.multiply(o))).mod(i);return this.serializeSig(o,a)},this.verifyWithMessageHash=function(t,e){return this.verifyHex(t,e,this.pubKeyHex)},this.verifyHex=function(t,e,r){var i,s,n,o=KJUR.crypto.ECDSA.parseSigHex(e);i=o.r,s=o.s,n=ECPointFp.decodeFromHex(this.ecparams.curve,r);var a=new BigInteger(t,16);return this.verifyRaw(a,i,s,n)},this.verify=function(t,e,r){var i,s,n;if(Bitcoin.Util.isArray(e)){var o=this.parseSig(e);i=o.r,s=o.s}else{if("object"!=typeof e||!e.r||!e.s)throw"Invalid value for signature";i=e.r,s=e.s}if(r instanceof ECPointFp)n=r;else{if(!Bitcoin.Util.isArray(r))throw"Invalid format for pubkey value, must be byte array or ECPointFp";n=ECPointFp.decodeFrom(this.ecparams.curve,r)}var a=BigInteger.fromByteArrayUnsigned(t);return this.verifyRaw(a,i,s,n)},this.verifyRaw=function(t,e,r,i){var s=this.ecparams.n,n=this.ecparams.G;if(e.compareTo(BigInteger.ONE)<0||e.compareTo(s)>=0)return!1;if(r.compareTo(BigInteger.ONE)<0||r.compareTo(s)>=0)return!1;var o=r.modInverse(s),a=t.multiply(o).mod(s),h=e.multiply(o).mod(s);return n.multiply(a).add(i.multiply(h)).getX().toBigInteger().mod(s).equals(e)},this.serializeSig=function(t,e){var r=t.toByteArraySigned(),i=e.toByteArraySigned(),s=[];return s.push(2),s.push(r.length),(s=s.concat(r)).push(2),s.push(i.length),(s=s.concat(i)).unshift(s.length),s.unshift(48),s},this.parseSig=function(t){var e;if(48!=t[0])throw new Error("Signature not a valid DERSequence");if(2!=t[e=2])throw new Error("First element in signature must be a DERInteger");var r=t.slice(e+2,e+2+t[e+1]);if(2!=t[e+=2+t[e+1]])throw new Error("Second element in signature must be a DERInteger");var i=t.slice(e+2,e+2+t[e+1]);return e+=2+t[e+1],{r:BigInteger.fromByteArrayUnsigned(r),s:BigInteger.fromByteArrayUnsigned(i)}},this.parseSigCompact=function(t){if(65!==t.length)throw"Signature has the wrong length";var e=t[0]-27;if(e<0||e>7)throw"Invalid signature type";var r=this.ecparams.n;return{r:BigInteger.fromByteArrayUnsigned(t.slice(1,33)).mod(r),s:BigInteger.fromByteArrayUnsigned(t.slice(33,65)).mod(r),i:e}},this.readPKCS5PrvKeyHex=function(t){var e,r,i,s=ASN1HEX,n=KJUR.crypto.ECDSA.getName,o=s.getVbyList;if(!1===s.isASN1HEX(t))throw"not ASN.1 hex string";try{e=o(t,0,[2,0],"06"),r=o(t,0,[1],"04");try{i=o(t,0,[3,0],"03").substr(2)}catch(t){}}catch(t){throw"malformed PKCS#1/5 plain ECC private key"}if(this.curveName=n(e),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(i),this.setPrivateKeyHex(r),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(t){var e,r,i,s=ASN1HEX,n=KJUR.crypto.ECDSA.getName,o=s.getVbyList;if(!1===s.isASN1HEX(t))throw"not ASN.1 hex string";try{o(t,0,[1,0],"06"),e=o(t,0,[1,1],"06"),r=o(t,0,[2,0,1],"04");try{i=o(t,0,[2,0,2,0],"03").substr(2)}catch(t){}}catch(t){throw"malformed PKCS#8 plain ECC private key"}if(this.curveName=n(e),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(i),this.setPrivateKeyHex(r),this.isPublic=!1},this.readPKCS8PubKeyHex=function(t){var e,r,i=ASN1HEX,s=KJUR.crypto.ECDSA.getName,n=i.getVbyList;if(!1===i.isASN1HEX(t))throw"not ASN.1 hex string";try{n(t,0,[0,0],"06"),e=n(t,0,[0,1],"06"),r=n(t,0,[1],"03").substr(2)}catch(t){throw"malformed PKCS#8 ECC public key"}if(this.curveName=s(e),null===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(r)},this.readCertPubKeyHex=function(t,e){5!==e&&(e=6);var r,i,s=ASN1HEX,n=KJUR.crypto.ECDSA.getName,o=s.getVbyList;if(!1===s.isASN1HEX(t))throw"not ASN.1 hex string";try{r=o(t,0,[0,e,0,1],"06"),i=o(t,0,[0,e,1],"03").substr(2)}catch(t){throw"malformed X.509 certificate ECC public key"}if(this.curveName=n(r),null===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(i)},void 0!==t&&void 0!==t.curve&&(this.curveName=t.curve),void 0===this.curveName&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),void 0!==t&&(void 0!==t.prv&&this.setPrivateKeyHex(t.prv),void 0!==t.pub&&this.setPublicKeyHex(t.pub))},KJUR.crypto.ECDSA.parseSigHex=function(t){var e=KJUR.crypto.ECDSA.parseSigHexInHexRS(t);return{r:new BigInteger(e.r,16),s:new BigInteger(e.s,16)}},KJUR.crypto.ECDSA.parseSigHexInHexRS=function(t){var e=ASN1HEX,r=e.getChildIdx,i=e.getV;if("30"!=t.substr(0,2))throw"signature is not a ASN.1 sequence";var s=r(t,0);if(2!=s.length)throw"number of signature ASN.1 sequence elements seem wrong";var n=s[0],o=s[1];if("02"!=t.substr(n,2))throw"1st item of sequene of signature is not ASN.1 integer";if("02"!=t.substr(o,2))throw"2nd item of sequene of signature is not ASN.1 integer";return{r:i(t,n),s:i(t,o)}},KJUR.crypto.ECDSA.asn1SigToConcatSig=function(t){var e=KJUR.crypto.ECDSA.parseSigHexInHexRS(t),r=e.r,i=e.s;if("00"==r.substr(0,2)&&r.length%32==2&&(r=r.substr(2)),"00"==i.substr(0,2)&&i.length%32==2&&(i=i.substr(2)),r.length%32==30&&(r="00"+r),i.length%32==30&&(i="00"+i),r.length%32!=0)throw"unknown ECDSA sig r length error";if(i.length%32!=0)throw"unknown ECDSA sig s length error";return r+i},KJUR.crypto.ECDSA.concatSigToASN1Sig=function(t){if(t.length/2*8%128!=0)throw"unknown ECDSA concatinated r-s sig  length error";var e=t.substr(0,t.length/2),r=t.substr(t.length/2);return KJUR.crypto.ECDSA.hexRSSigToASN1Sig(e,r)},KJUR.crypto.ECDSA.hexRSSigToASN1Sig=function(t,e){var r=new BigInteger(t,16),i=new BigInteger(e,16);return KJUR.crypto.ECDSA.biRSSigToASN1Sig(r,i)},KJUR.crypto.ECDSA.biRSSigToASN1Sig=function(t,e){var r=KJUR.asn1,i=new r.DERInteger({bigint:t}),s=new r.DERInteger({bigint:e});return new r.DERSequence({array:[i,s]}).getEncodedHex()},KJUR.crypto.ECDSA.getName=function(t){return"2a8648ce3d030107"===t?"secp256r1":"2b8104000a"===t?"secp256k1":"2b81040022"===t?"secp384r1":-1!=="|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(t)?"secp256r1":-1!=="|secp256k1|".indexOf(t)?"secp256k1":-1!=="|secp384r1|NIST P-384|P-384|".indexOf(t)?"secp384r1":null};const B=window.BigInteger,x=window.KJUR.crypto.ECDSA,N=o.shake256,D=new x({curve:"secp256k1"}),C=D.ecparams.keylen/4;function E(t){return"0x"===t.substr(0,2)?t.substr(2):t}function R(t){const e=200003,r=new Array(e);for(let i=0;i<e;i++)t=N.create(256).update(t).array(),r[i]=t.slice(-16);r.sort(function(t,e){for(let r=0;r<64;r++)if(t[r]!==e[r])return t[r]<e[r]?-1:1;return 0});const i=N.create(512);for(let t=0;t<e;t++)i.update(r[t]);return i.toString()}return x.biRSSigToASN1Sig=function(t,e){return("000000000000000"+t.toString(16)).slice(-C)+("000000000000000"+e.toString(16)).slice(-C)},x.parseSigHex=function(t){return{r:new B(t.substr(0,C),16),s:new B(t.substr(C),16)}},{hash:function(t){return console.info("sss"),N.create(256).update(t).toString()},xhash:R,privateKeyBySecret:function(t){return"0x"+(e=R(t).toString().substring(0,C),new B(e,16).mod(D.ecparams.n).add(B.ONE).toString(16));var e},publicKeyByPrivate:function(t){const e=D.ecparams.G.multiply(new B(E(t),16));return"0x"+("000000000000000"+e.getX().toBigInteger().toString(16)).slice(-C)+("000000000000000"+e.getY().toBigInteger().toString(16)).slice(-C)},addressByPublic:function(t){let e=function(t){const e=(t=E(t)).length>>1,r=new Array(e);for(let i=0;i<e;i++)r[i]=parseInt(t.substr(i<<1,2),16);return r}(t);return e=N.create(512).update(e).array(),"0x"+(e=N.create(512).update(e)).toString().slice(-48)}}}();
